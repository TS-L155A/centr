<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Корзина</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous">
</head>
<body>
<header th:insert="~{blocks/header :: header}"></header>

<div class="container mt-5">
    <h1 class="mb-4">Ваша корзина</h1>

    <table class="table table-striped">
        <thead>
        <tr>
            <th>Название</th>
            <th>Кол-во</th>
            <th>Цена при добавлении</th>
            <th>Текущая цена</th>
            <th>Действия</th>
        </tr>
        </thead>
        <tbody>
        <!-- Если корзина пуста -->
        <tr th:if="${#lists.isEmpty(cart.items)}">
            <td colspan="5" class="text-center">Корзина пуста</td>
        </tr>

        <!-- Список товаров -->
        <tr th:each="item : ${cart.items}">
            <td th:text="${item.havka.title}">Название</td>
            <td th:text="${item.quantity}">1</td>
            <td th:text="${#numbers.formatDecimal(item.priceAtAdd, 0, 'POINT')} + ' ₸'">0 ₸</td>
            <td th:text="${#numbers.formatDecimal(item.priceCurrent != null ? item.priceCurrent : item.priceAtAdd, 0, 'POINT')} + ' ₸'">0 ₸</td>
            <td>
                <form th:action="@{/cart/increase/{id}(id=${item.id})}" method="post" style="display:inline">
                    <button class="btn btn-sm btn-success">+</button>
                </form>
                <form th:action="@{/cart/decrease/{id}(id=${item.id})}" method="post" style="display:inline">
                    <button class="btn btn-sm btn-warning">-</button>
                </form>
                <form th:action="@{/cart/remove/{id}(id=${item.id})}" method="post" style="display:inline">
                    <button class="btn btn-sm btn-danger">x</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- Кнопка оформления заказа -->
    <div th:if="${!#lists.isEmpty(cart.items)}" class="text-end mt-3">
        <a href="/order/checkout" class="btn btn-primary">Оформить заказ</a>
    </div>
</div>

<footer th:insert="~{blocks/footer :: footer}"></footer>
</body>
</html>
